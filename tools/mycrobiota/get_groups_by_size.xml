<tool id="mycrobiota_get_groups_by_size" name="Get groups" version="0.1" profile="16.07">
    <description>based on number of sequences</description>
    <requirements>
        <requirement type="package" version="1.36.1">mothur</requirement>
    </requirements>
    <command detect_errors="aggressive"><![CDATA[
        ln -s "$in_fasta" fasta.dat
        && ln -s "$in_group" group.dat

        ## mothur count.groups on in_fasta
        && echo 'count.groups(group=group .dat)' | sed 's/ //g' | mothur
        && tree

        ## get group names with fewer than threshold reads and make dash-separated list
        #set $getgroups='\n'.join(' '.join(c) for c in zip(*(l.split() for l in open('group.count.summary').readlines() if l.strip()))).split('\n')[1].replace(' ','-')


        ## get.groups on in_fasta with this list of groups, output in out_fasta
        && echo 'get.groups(fasta=fasta.dat, groups=$getgroups)' | sed 's/ //g' | mothur

        && tree
    ]]></command>
    <inputs>
        <param name="in_fasta" type="data" format="fasta" label="Input fasta"/>
        <param name="in_group" type="data" format="mothur.group" label="Input group file"/>
        <param name="threshold" type="integer" value="" min="0" label="Threshold - minimum or maximum number of sequences in a group" />
    </inputs>
    <outputs>
        <data name="out_fasta" format="fasta" label="${tool.name} on ${on_string}: fasta of selected groups"/>
    </outputs>
    <tests>
    </tests>
    <help><![CDATA[
**What it does**
filter fasta file by group based on number of sequences in the group.
    ]]></help>
    <citations>
    </citations>
</tool>
