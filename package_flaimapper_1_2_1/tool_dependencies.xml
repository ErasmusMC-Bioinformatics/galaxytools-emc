<?xml version="1.0"?>
<tool_dependency>
	<!--
		pysam has had several internal changes in 0.7.*, 0.8.1, 0.8.2 &
		0.8.3 and therefore FlaiMapper is not compatible with all of
		them. For compatibility this package is provided with pysam
		0.8.2.1 which was not originally in the toolshed.
	-->
	<package name="pysam" version="0.8.2.1">
		<repository name="package_pysam_0_8_2" owner="yhoogstrate" prior_installation_required="True" />
	</package>
	
	<package name="flaimapper" version="1.2.1">
		<install version="1.0">
			<actions>
				<action type="set_environment_for_install">
					<repository name="package_pysam_0_8_2" owner="yhoogstrate">
						<package name="pysam" version="0.8.2.1" />
					</repository>
				</action>
				
				<action type="make_directory">$INSTALL_DIR/bin</action>
				<action type="make_directory">$INSTALL_DIR/lib/python</action>
				<action type="make_directory">$INSTALL_DIR/lib64/python</action>
				
				<action type="shell_command">
					git clone https://github.com/yhoogstrate/flaimapper flaimapper	&amp;&amp;
					cd flaimapper													&amp;&amp;
					git reset --hard d3cc32a10ba3d33fde4cb76e8013a51ec8bdf779		&amp;&amp;
					
					export PYTHONPATH=$PYTHONPATH:$INSTALL_DIR						&amp;&amp;
					export PYTHONPATH=$PYTHONPATH:$INSTALL_DIR"/lib/python"			&amp;&amp;
					export PYTHONPATH=$PYTHONPATH:$INSTALL_DIR"/lib64/python"		&amp;&amp;
					export PYTHONPATH=$PYTHONPATH:$PYSAM_PATH						&amp;&amp;
					export PYTHONPATH=$PYTHONPATH:$PYSAM_PATH"/lib/python"			&amp;&amp;
					export PYTHONPATH=$PYTHONPATH:$PYSAM_PATH"/lib64/python"		&amp;&amp;
					
					cd src															&amp;&amp;
					
					python setup.py build											&amp;&amp;
					python setup.py install --home $INSTALL_DIR --install-scripts $INSTALL_DIR/bin
				</action>
				
				<action type="set_environment">
					<environment_variable action="append_to" name="PYTHONPATH">$INSTALL_DIR:$INSTALL_DIR/lib/python:$INSTALL_DIR/lib64/python</environment_variable>
					<environment_variable action="prepend_to" name="PATH">$INSTALL_DIR/bin</environment_variable>
				</action>
			</actions>
		</install>
		
		<readme>
			Downloads and installs FlaiMapper. Prerequisites:
				- git
			
			Because I accidentally included too much large files within
			the GitHub repository of FlaiMapper it has become large.
			This explains why installation takes a while.
		</readme>
	</package>
</tool_dependency>
